module.exports.config = {
    name: '/tikwm.json',
    credits: 'DC-Nam',
    description: 'tikwm.com',
    client: {
        limit_request: [10,
            60]
    },
    contacts: {
        facebook: 'www.facebook.com/levy.nam.2k5'
    },
    method: 'get',
    docs: '{url}, query: video, music, user, trending, search'
};
const {
    post
} = require('axios'),
tikwm = `https://www.tikwm.com`;
module.exports.run = async function({
    req, res, next, utils, config, address
}) {
    try {
        const {
            user,
            video,
            music,
            trending,
            search
        } = req.query;
        var data;
        if(Object.keys(req.query).length==0)return res.send(`<p>?user=id người dùng</p><p>?video=link video</p><p>?music=id nhạc</p><p>?trending=Trending nước nào ghi vào</p><p>?search=từ khóa</p>`);
          if (user) data = (await post(`${tikwm}/api/user/posts`, {
            unique_id: user
        })).data;
        if (video) data = (await post(`${tikwm}/api/`, {
            url: video
        })).data;
        if (music) data = (await post(`${tikwm}/api/music/posts`, {
            music_id: music
        })).data;
        if (trending) data = (await post(`${tikwm}/api/feed/list`, {
            region: trending
        })).data;
        if (search) data = (await post(`https://tikwm.com/api/feed/search?keywords=${search}`)).data;
        res.json(data);
    }catch(err) {
        console.log(err);
        res.json(err);
    };
};